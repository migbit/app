<!DOCTYPE html>
<html lang="pt-pt">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Caixa</title>
    <link rel="stylesheet" href="../css/styles.css">
    <link rel="icon" href="favicon.ico" type="image/x-icon">
</head>
<body>
    <header>
        <h1>Caixa</h1>
    
        <!-- Ícone de menu "hambúrguer" para mobile -->
        <div class="menu-icon" id="menu-icon">
            &#9776; <!-- Ícone de três linhas -->
        </div>
    
        <nav id="nav-menu">
            <ul>
                <li><a href="mensagens.html">Mensagens</a></li>
                <li><a href="ficheiros.html">Ficheiros</a></li>
                <li class="separator">|</li>
                <li><a href="compras.html">Compras</a></li>
                <li><a href="faturas.html">Faturas / Relatórios</a></li>
                <li><a href="caixa.html" class="active">Caixa</a></li>
                <li><a href="reparações.html">Reparações</a></li>
                <li><a href="tarefas.html">Tarefas</a></li>             
                <li><a href="hospedes.html">Hóspedes</a></li>
                <li><a href="cenas.html">Cenas</a></li>
                <li class="separator">|</li>
                <!-- Login/User section, controlled by server-side or CSS visibility -->
                <li id="login-section">
                    <a href="#" id="login-btn" class="login-visible">Login</a>
                    <span id="user-info" class="user-visible" style="display:none;">
                        <a href="#" id="user-name">Username</a> <!-- Visible if logged in -->
                    </span>
                </li>
            </ul>
        </nav>
    </header>


  <main class="caixa-wrapper">
    <section class="section-card">
      <h2>Registar transação</h2>
      <form id="caixa-form" class="form-grid" autocomplete="off">
        <div>
          <label for="data">Data</label>
          <input type="date" id="data" required>
        </div>
        <div>
          <label for="descricao">Descrição</label>
          <input type="text" id="descricao" placeholder="Ex.: Pagamento, Troco, etc." required>
        </div>
        <div>
          <label for="valor">Valor (€)</label>
          <input type="text" id="valor" inputmode="decimal" placeholder="0,00" required>
          <div class="inline-help muted">Até €999.999,00 • aceita vírgula ou ponto</div>
        </div>
        <div>
          <label for="caixa-select">Caixa</label>
          <select id="caixa-select" required>
            <option value="Caixa Banco" selected>Caixa Banco</option>
            <option value="Caixa Direita">Caixa Direita</option>
            <option value="Caixa Esquerda">Caixa Esquerda</option>
          </select>
        </div>
        <div class="checkbox-wrap">
          <input type="checkbox" id="flag-p" disabled>
          <label for="flag-p" title='"P" só para Direita/Esquerda'>Marcar como “P”</label>
        </div>
        <div class="btn-row">
          <input type="hidden" id="tipo" value="Entrada">
          <button type="button" id="btn-entrada" class="btn">Entrada</button>
          <button type="button" id="btn-saida" class="btn">Saída</button>
          <button type="submit" class="btn">Guardar</button>
        </div>
      </form>
    </section>

    <!-- Blocos de relatório por caixa -->
    <section id="bloco-banco" class="section-card">
      <h2>Caixa Banco</h2>
      <div class="muted pill">Sem “P”</div>
      <table class="tx-table" id="table-banco">
        <thead><tr><th>Data</th><th>Tipo</th><th>Descrição</th><th>Valor</th></tr></thead>
        <tbody></tbody>
      </table>
      <div class="totals-line"><span class="muted">Subtotal (sem P):</span><span id="subtotal-banco">€0,00</span></div>
    </section>

    <section id="bloco-direita" class="section-card">
      <h2>Caixa Direita</h2>
      <div class="pill">Movimentos</div>
      <table class="tx-table" id="table-direita">
        <thead><tr><th>Data</th><th>Tipo</th><th>Descrição</th><th>Valor</th></tr></thead>
        <tbody></tbody>
      </table>
      <div class="totals-line"><span class="muted">Subtotal (sem P):</span><span id="subtotal-direita-np">€0,00</span></div>
      <div class="totals-line"><span class="muted">Subtotal (P):</span><span id="subtotal-direita-p">€0,00</span></div>
    </section>

    <section id="bloco-esquerda" class="section-card">
      <h2>Caixa Esquerda</h2>
      <div class="pill">Movimentos</div>
      <table class="tx-table" id="table-esquerda">
        <thead><tr><th>Data</th><th>Tipo</th><th>Descrição</th><th>Valor</th></tr></thead>
        <tbody></tbody>
      </table>
      <div class="totals-line"><span class="muted">Subtotal (sem P):</span><span id="subtotal-esquerda-np">€0,00</span></div>
      <div class="totals-line"><span class="muted">Subtotal (P):</span><span id="subtotal-esquerda-p">€0,00</span></div>
    </section>

    <section class="section-card">
      <h2>Totais finais</h2>
      <div class="footer-totals">
        <div><span class="muted">Total (sem P):</span> <strong id="total-sem-p">€0,00</strong></div>
        <div><span class="muted">Total (P):</span> <strong id="total-p">€0,00</strong></div>
      </div>
      <div class="export-row">
        <button id="btn-export" class="btn">Exportar CSV</button>
      </div>
    </section>
  </main>

  <script type="module" src="../js/caixa.js"></script>

  <script>
    const menuIcon = document.getElementById('menu-icon');
    const navMenu = document.getElementById('nav-menu');
    if (menuIcon && navMenu) {
      menuIcon.addEventListener('click', function(){ navMenu.classList.toggle('active'); });
    }
  </script>
</body>
</html>
